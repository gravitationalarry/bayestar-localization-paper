\documentclass{iopart}
\usepackage{iopams}
\usepackage{bib/aas_macros}
\usepackage[colorlinks]{hyperref}
\input{ligo-acronyms/acronyms}

% From http://www.f.kth.se/~ante/latex.php
\setlength{\marginparwidth}{1.2in}
\let\oldmarginpar\marginpar
\renewcommand\marginpar[1]{\-\oldmarginpar[\raggedleft\footnotesize #1]%
{\raggedright\footnotesize #1}}

\begin{document}

\title[Rapid-response Bayesian sky localization]{Rapid-response Bayesian sky localization for electromagnetic follow-up of gravitational-wave candidates}
\author{Leo Singer and Larry R. Price}
\address{LIGO Laboratory, California Institute of Technology, Pasadena, CA 91125, USA}
\ead{\mailto{leo.singer@ligo.org}, \mailto{larryp@caltech.edu}}

\begin{abstract}
Timely \acl{EM} follow\nobreakdashes-up of \acl{CBC} events detected by \acl{aLIGO} requires rapidly inferring the sky location from the \ac{GW} observations.  Calculation of the posterior distribution of the sky location and intrinsic source parameters given the \ac{GW} strain takes hours with state\nobreakdashes-of\nobreakdashes-the\nobreakdashes-art \ac{MCMC} parameter estimation codes.  By taking as the measurement not the \ac{GW} strain itself but the amplitude and \acl{TOA} of the putative signal at each detector, and by fixing the intrinsic source parameters, we have constructed a non-\ac{MCMC}, fully deterministic Bayesian parameter estimation algorithm that takes just seconds to produce sky maps of posterior probability.%
\marginpar{Wrong emphasis?  I like Larry's idea of having this paper discuss several different tiers of sky localization with increasing accuracy and latency.}
\end{abstract}

\section{Outline}

\begin{enumerate}
\item Introduction {
	\begin{enumerate}
	\item Background: \acp{GRB}, \acp{CBC}, \acs{LIGO}
	\item Time scales of \acp{GRB}, \acp{CBC}
	\item Current sky localization algorithms and response times
	\end{enumerate}
}
\item Preliminaries {
	\begin{enumerate}
	\item Fisher information, \ac{CRLB}
	\item Matched\nobreakdashes-filter estimator
	\end{enumerate}
}
\item Algorithm {
	\begin{enumerate}
	\item Assumptions
	\item Signal model
	\item Likelihood function
	\item Priors and marginalization
	\item Procedure
	\end{enumerate}
}
\item Results {
	\begin{enumerate}
	\item Injection population
	\item Cumulative fraction vs. confidence level plots
	\item Sky localization accuracy as a function of distance or \ac{SNR}
	\item Speed
	\end{enumerate}
}
\item Discussion {
	\begin{enumerate}
	\item Potential further refinements
	\item What astrophysical targets were accessible before
	\item What new targets are available with the response time of seconds
	\item Lay out timeline of follow\nobreakdashes-up campaign, including different tiers of inference and different types of telescopes
	\end{enumerate}
}
\item Appendices {
	\begin{enumerate}
	\item Code listing?
	\item Any proofs that are needed in the body but would interrupt the text?
	\end{enumerate}
}
\end{enumerate}


\section{Measurement uncertainty}

\marginpar{Bad to start a paragraph with a citation number. Perhaps switch to natbib and use a \texttt{citet}-style reference. Keep this derivation as short as possible. Refer more directly to \cite{fairhurst:2009}. Tighten up notation as much as possible while still giving a concise description of the Cram\`er-Rao bound.}%
%
\cite{fairhurst:2009} estimated the uncertainty in the matched-filter measurement of the \ac{TOA} of a \ac{GW} signal by computing the scalar Fisher information.  We extend this result by computing the Fisher information matrix describing the uncertainties in the joint estimation of the signal amplitude and \ac{TOA}.

When a \ac{CBC} occurs, a detector's strain observation may be described by a linear combination of two orthogonal \ac{GW} quadratures and additive, zero\nobreakdashes-mean, \acl{WSS}, Gaussian measurement noise $n(t)$, with one-sided power spectral density $S(f)$. In the frequency domain, the detector's observation $\tilde x (\omega)$ is given by
%
\begin{equation}\label{eq:signal-model}
	\tilde x (\omega) = \tilde h (\omega, \rho, \gamma, \tau) + \tilde n (\omega) = \rho e^{\imath (\gamma - \omega \tau)} \tilde u (\omega) + \tilde n (\omega).
\end{equation}
%
where $\tilde h (\omega)$ is the signal content, $\tilde n (\omega)$ is the detector's noise, $\tilde u (\omega)$ is the frequency-domain post-Newtonian inspiral signal, $\rho$ is the signal's amplitude, $\gamma$ is a phase angle the encodes the relative strength of the two \ac{GW} quadratures, and $\tau$ is the time of arrival relative to an arbitrary time base.

The Fisher information matrix for a measurement $\tilde x$ described by the unknown parameter vector $\boldsymbol{\theta}$ may be written as
%
\begin{equation}\label{eq:general-fisher-matrix}
	\mathcal{I}_{jk} = \mathrm{E} \, \left[
		-\frac{\partial^2 \log
			\mathcal{L}(\tilde x ; \boldsymbol\theta)}
			{\partial \theta_j \theta_k}
	\right].
\end{equation}
%
This equation involves double derivatives, but substantial simplification is possible when the likelihood is Gaussian. First, we write the likelihood of the data $\tilde x (\omega)$ given the parameter vector $\boldsymbol\theta = (\rho, \gamma, \tau)$:
%
\begin{equation}\label{eq:gaussian-likelihood}
	\mathcal{L}(\tilde x; \boldsymbol\theta) = p(\tilde x | \boldsymbol\theta)
		\propto \exp \left[
		- \frac{1}{2} \int_0^\infty \frac{\left|\tilde x (\omega)
			- \tilde h (\omega; \boldsymbol\theta) \right|^2}{S(\omega)} \, \mathrm{d}\omega
	\right].
\end{equation}
%
The normalization has been dropped because the Fisher matrix elements depend only on derivatives of the log\nobreakdashes-likelihood function and any factor that is independent of the parameters makes no contribution. Now, substituting \eref{eq:gaussian-likelihood} into \eref{eq:general-fisher-matrix} gives us
%
\begin{equation}\label{eq:gaussian-fisher-matrix}
	\mathcal{I}_{jk} = \int_0^\infty \Re \left[
        \left(\frac{\partial \tilde h}{\partial \theta_j}\right)^*
        \left(\frac{\partial \tilde h}{\partial \theta_k}\right)
	\right] \frac{1}{S(\omega)} \, \mathrm{d}\omega.
\end{equation}
%
where $\Re$ denotes the real part and $^*$ the complex conjugate. This form is more useful because it involves only first derivatives, and of the signal $\tilde h (\omega)$ rather than the entire observation $\tilde x (\omega)$.

If the waveform $\tilde u (\omega)$ is normalized such that $\mathcal{I}_{\rho\rho} = 1$, we can introduce the \textit{\ac{SNR}-weighted moments of angular frequency},
%
\begin{equation}\label{eq:angular-frequency-moments}
    \overline{\omega^k} =
        \left[ \int_0^\infty \frac{|\tilde u (\omega)|^2}{S(\omega)} \omega^k \, \mathrm{d}\omega \right]
        \left[ \int_0^\infty \frac{|\tilde u (\omega)|^2}{S(\omega)} \, \mathrm{d}\omega \right]
\end{equation}
%
Then, we have
%
\begin{eqnarray*}
	\mathcal{I} = \bordermatrix{
        ~ & \rho & \gamma & \tau \cr
        \rho & 1 & 0 & 0 \cr
        \gamma & 0 & \rho^2 & -\rho^2 \overline{\omega} \cr
        \tau & 0 & -\rho^2 \overline{\omega} & \rho^2 \overline{\omega^2}
    }.
\end{eqnarray*}

\section{Posterior distribution}

\marginpar{This material still has the original, wrong Fishher matrix. Needs to be rewritten.}%
%
Because the \ac{CRLB} in \Eref{eq:cramer-rao} is diagonal, joint estimators of $(\rho_A, \rho_B, t_0)$ may exist for which the error in the estimation of the individual parameters is uncoupled up to second order.  If the detector's noise is Gaussian, then the outputs of matched filters for $a(t)$ and $b(t)$ will themselves be Gaussian.  This encourages us to make the approximation that the errors in $(\rho_A, \rho_B, t_0)$ by a matched\nobreakdashes-filter estimator are independent and Gaussian with variance equal to the \ac{CRLB}.  A wrinkle is that $\mathcal{I}_{t_0,t_0}$ depends on the true values of $\rho_A$ and $\rho_B$.  If we make the further leap of evaluating the \ac{CRLB} \emph{at the value of the estimators}, we can write
%
\begin{eqnarray}
\hat{\rho}_A - \rho_A \sim \mathcal{N}\, [0, 1] \\
\hat{\rho}_B - \rho_B \sim \mathcal{N}\, [0, 1] \\
\hat{t}_0 - t_0 \sim \mathcal{N} \left[0, \frac{1}{2 \pi f_\mathrm{rms} \sqrt{{\hat{\rho}_A}^2 + {\hat{\rho}_B}^2}}\right].
\end{eqnarray}


\marginpar{This part is correct, but uses the old notation for the frequency moments. Convert to the new notation. Also, add physical interpretation to each change of variables.}%
%
Now we will perform four changes of variables. The first change of variables is from $C$ to $\rho = \sqrt{M_0}C$. This change is intended to make the variance of the absolute value of the amplitude equal to one. 
\[
\mathcal{I} =
\left( {\begin{array}{ccc}
 1 & 0 & 0 \\
 0 & \rho^2 & -2\pi\rho^2 N_1 \\
 0 & -2\pi\rho^2 N_1 & 4\pi^2 \rho^2 N_2
 \end{array} } \right)
\]

The second from $t$ to $\phi_t = t2\pi \sqrt{N_2}$ is meant to get rid of $t_0$,
\[
\mathcal{I} =
\left( {\begin{array}{ccc}
 1 & 0 & 0 \\
 0 & \rho^2 & -\rho^2\frac{N_1}{\sqrt{N_2}} \\
 0 & -\rho^2\frac{N_1}{\sqrt{N_2}} & \rho^2
 \end{array} } \right)
\]

The third introduces two new variables, $\phi_s = \frac{1}{\sqrt{2}}(\phi + \phi_t)$ and $\phi_d = \frac{1}{\sqrt{2}}(\phi - \phi_t)$. This change of variables diagonalizes the matrix.
\[
\mathcal{I} =
\left( {\begin{array}{ccc}
 1 & 0 & 0 \\
 0 & (1 - \frac{N_1}{\sqrt{N_2}})\rho^2 & 0 \\
 0 & 0 & (1 + \frac{N_1}{\sqrt{N_2}})\rho^2
 \end{array} } \right)
\]

Now we'll do a final change of variables to make the phase parameters have the same variance. We let $\alpha_s = \phi_s \sqrt{1 - \frac{N_1}{\sqrt{N_2}}}$ and $\alpha_d = \phi_d \sqrt{1 - \frac{N_1}{\sqrt{N_2}}}$ which gives us the matrix
\[
\mathcal{I} =
\left( {\begin{array}{ccc}
 1 & 0 & 0 \\
 0 & \rho^2 & 0 \\
 0 & 0 & \rho^2
 \end{array} } \right)
\]



\ack Source code for \ac{BAYESTAR} is available on the \acs{LIGO} \acl{DASWG} web site at \url{http://www.lsc-group.phys.uwm.edu/daswg/projects/bayestar.html}.

Some of the results in this paper have been derived using HEALPix \cite{healpix}.

\acs{LIGO} was constructed by the California Institute of Technology and Massachusetts Institute of Technology with funding from the \ac{NSF} and operates under cooperative agreement PHY\nobreakdashes-0107417.  Some results were produced on the NEMO computing cluster operated by the Center for Gravitation and Cosmology at University of Wisconsin\nobreakdashes--Milwaukee under \ac{NSF} Grants PHY\nobreakdashes-0923409 and PHY\nobreakdashes-0600953.  This research is supported by the \ac{NSF} through a Graduate Research Fellowship to L.S.  This paper has \acs{LIGO} Document Number \acs{LIGO}\nobreakdashes-PXXXXXXX\nobreakdashes-vX.


\section*{References}
\bibliographystyle{iopart-num}
\bibliography{apj-jour,bib/telescope}

\end{document}
